<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <!-- Use W3.CSS CDN so `w3-indigo` and other classes are available -->
        <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
        <!-- QR Code Scanner Library -->
        <script src="https://unpkg.com/html5-qrcode"></script>
        <title>QR reader</title>
        <style>
            /* small local tweaks to match screenshot proportions */
            .viewer-box {
                width: 300px;
                height: 300px;
                border: 2px solid #222;
                display: inline-block;
                background: white;
            }
            #qr-reader {
                width: 100%;
                height: 100%;
            }
            .page-wrap { min-height: 80vh; }
            .page-footer { padding-top: 18px; padding-bottom: 18px; }
        </style>
    </head>
    <body class="w3-white">
        <!-- Header: left title, right login -->
        <div class="w3-bar w3-indigo w3-text-white">
            <div class="w3-bar-item w3-large">Python(20420) 10:30 - 12:01 MW</div>
            <a href="/login" class="w3-bar-item w3-button w3-right w3-small w3-text-white">LOGIN</a>
        </div>

        <!-- Main content area -->
        <div class="w3-container page-wrap">
            <div class="w3-row">
                <div class="w3-col m3 l3">&nbsp;</div>
                <div class="w3-col s12 m6 l6 w3-center" style="margin-top:48px;">
                    <div class="viewer-box" id="qr-reader"></div>
                </div>
                <div class="w3-col m3 l3">&nbsp;</div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="w3-container w3-light-grey w3-border-top page-footer">
            <div class="w3-center w3-small">&copy; Jude Khalil Veloso, Rasheed Boriss Yap, 2025</div>
        </footer>

        <script>
            // Initialize QR Code Scanner
            const html5QrcodeScanner = new Html5QrcodeScanner(
                "qr-reader",
                { fps: 10, qrbox: 250 },
                false
            );

            html5QrcodeScanner.render(onScanSuccess, onScanFailure);

            function onScanSuccess(decodedText, decodedResult) {
                console.log(`QR Code detected: ${decodedText}`);
                // You can process the scanned QR code here
                // For example, send it to your Flask backend
                fetch('/scan-qr', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ qr_code: decodedText })
                })
                .then(response => response.json())
                .then(data => {
                    console.log('Server response:', data);
                    // Handle the response from your backend
                })
                .catch(error => console.error('Error:', error));
            }

            function onScanFailure(error) {
                // Handle errors gracefully (optional)
            }
        </script>

    </body>
</html>